# 7.3.2 实例化 beans #
bean 定义本质上来说是用于创建一个或多个对象的“食谱”。容器在被请求的时候，根据 bean 的名称查询相应的“食谱”，并使用封装在 bean 定义中的配置元信息创建（或取得）一个实际的对象。
如果开发者使用基于 XML 的配置元信息，开发者需要在`<bean/>`元素之中通过`class`属性指明要被实例化的对象的类。`class`属性通常强制的作为`BeanDefinition`实例的`Class`字段出现（例外的情况，请参见[《使用实例工厂方法进行实例化》][instance_factory]和[《7.7 bean 定义的继承》][bean_inheritance]）。开发者可以通过以下两种方式使用`Class`字段：
* 特别地，指明被构造的 bean 的类型，从而让容器通过反射地方式直接创建 bean，这与直接使用`new`操作符进行实例化的 Java 代码是等价的* 指明含有用于创建对象的`static`工厂方法的类，从而让容器调用工厂方法创建相应对象，被调用的静态工厂方法所返回的对象的类型可能是相同的类或者是完全不同的类
**内部类名称** 的使用。如果开发者希望为`static`内部类配置 bean 定义，就必须使用内部类的 *二进制* 名称。
例如，如果在包`com.example`中有类`Foo`，并且`Foo`类有静态内部类`Bar`，则`class`属性的值应该是`com.example.Foo$Bar`
注意使用`$`字符分割内部类和外部类的类名
## 使用构造器实例化 bean ##
当开发者使用构造器的方式创建 bean，所有普通的类都可以在 Spring 使用并被其兼容。也就是说，开发者在定义类的时候不需要实现特定的接口或者使用特殊的编码风格，简单的声明类的 bean 就足够了。然而，根据开发者为 bean 制定的 IoC 管理方式的不同，可能需要类有默认的（空的）构造器
事实上 Spring IoC 容器可以管理 *任何* 开发者希望其管理的类，且不受 JavaBean 规范的限制。大部分 Spring 开发者更喜欢将 JavaBean 实现为仅含有一个默认（无参）构造器、一些适当的、模式化的 setter 和 getter 用于容器中已有的属性。开发者也可以在容器中配置很多外部的非 bean 风格的类。例如：如果开发者需要使用遗留的、肯定不会遵循 JavaBean 规范的链接池，也可以使用 Spring 管理
开发者可以使用基于 XML 配置元信息定义 bean：```xml<bean id="exampleBean" class="examples.ExampleBean"/>
<bean name="anotherExample" class="examples.ExampleBeanTwo"/>```
更多关于为构造器提供属性（如果需要）和在对象创建之后设置对象实例化属性的机制请参见[注入依赖][injecting]
## 使用静态工厂方法实例化 bean ##
当使用静态工厂方式创建的对象定义 bean 的时候，开发者可以使用`class`属性指明含有`static`工厂方法的类，并使用`factory-method`方法指明工厂方法名。开发者应该通过（使用可选的参数，之后会介绍）调用此方法返回接下来需要处理的实例对象，即使此对象已经被构造方法创建。这种 bean 定义方式的一种用途就是调用遗留代码中的`static`工厂
以下的 bean 定义指明了用于创建 bean 的工厂方法。该定义没有指明返回对象的类型，仅指明了含有工厂方法的类。在该示例中，`createInstance()`方法必须是`static`方法。
```xml<bean id="clientService"    class="examples.ClientService"    factory-method="createInstance"/>```
```javapublic class ClientService {    private static ClientService clientService = new ClientService();    private ClientService() {}
    public static ClientService createInstance() {        return clientService;    }}```
更多关于为构造器提供属性（如果需要）和在对象创建之后设置对象实例化属性的机制请参见[依赖和配置细节][dependencies_detail]
## 使用实例工厂方法实例化 bean ##
与静态工厂方法实例化 bean 相似的，使用实例工厂方法实例化 bean 就是触发容器中已有 bean 的非静态方法创建一个新的 bean。为了使用此机制，不能够设置`class`属性，并在`factory-bean`属性中指明一个当前容器（或其父容器）已有的 bean，通过调用此 bean 的实例方法创建对象；然后再`factory-method`属性中指明此实例工厂方法
```xml<!-- 此工厂 bean 含有名为 createInstance() 的实例方法 --><bean id="serviceLocator" class="examples.DefaultServiceLocator">    <!-- inject any dependencies required by this locator bean --></bean>
<!-- 此 bean 为工厂 bean 创建的 --><bean id="clientService"    factory-bean="serviceLocator"    factory-method="createClientServiceInstance"/>```
```javapublic class DefaultServiceLocator {
    private static ClientService clientService = new ClientServiceImpl();    private DefaultServiceLocator() {}
    public ClientService createClientServiceInstance() {        return clientService;    }}```
一个工厂类可以持有超过一个工厂方法：
```xml<bean id="serviceLocator" class="examples.DefaultServiceLocator">    <!-- 使用 locator bean 可以插入任意依赖 --></bean>
<bean id="clientService"    factory-bean="serviceLocator"    factory-method="createClientServiceInstance"/>
<bean id="accountService"    factory-bean="serviceLocator"    factory-method="createAccountServiceInstance"/>```
```javapublic class DefaultServiceLocator {
    private static ClientService clientService = new ClientServiceImpl();    private static AccountService accountService = new AccountServiceImpl();
    private DefaultServiceLocator() {}
    public ClientService createClientServiceInstance() {        return clientService;    }
    public AccountService createAccountServiceInstance() {        return accountService;    }
}```
此方法展示了如何通过依赖注入管理和配置工厂 bean。更为详细的内容请参见[依赖和配置细节][dependencies_detail]
>![icon][icon]在 Spring 文档中，`factory bean`（工厂 bean）的含义是配置在 Spring 容器中、可以通过其实例或静态方法创建对象的 bean。相比之下，`FactoryBean`（注意大小写）意味着 Spring 定制的[`FactoryBean`][factorybean]

<!-- 链接 -->[instance_factory]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-factory-class-instance-factory-method[bean_inheritance]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-child-bean-definitions "《7.7 bean 定义的继承》"[injecting]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-factory-collaborators "《7.4.1 依赖注入》"[dependencies_detail]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-factory-properties-detailed "《7.4.2 依赖和配置细节》"[icon]: ./pic/icon.png[factorybean]: http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#beans-factory-extension-factorybean "《7.8.3 使用 FactoryBean 的定制实例化逻辑》"
